<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<model type="com.apple.IDECoreDataModeler.DataModel" documentVersion="1.0" lastSavedToolsVersion="23507" systemVersion="23F79" minimumToolsVersion="Xcode 15.0" sourceLanguage="Swift" usedWithCloudKit="YES" userDefinedModelVersionIdentifier="">

    <!-- Note Entity - Enhanced for AI Processing -->
    <entity name="Note" representedClassName="Note" syncable="YES" codeGenerationType="class">
        <!-- Basic Information -->
        <attribute name="id" attributeType="UUID" defaultValueString="00000000-0000-0000-0000-000000000000"/>
        <attribute name="title" attributeType="String" defaultValueString="Untitled Note"/>
        <attribute name="timestamp" attributeType="Date" defaultDateTimeInterval="0" usesScalarValueType="NO"/>
        <attribute name="lastModified" attributeType="Date" defaultDateTimeInterval="0" usesScalarValueType="NO"/>
        <attribute name="isFavorite" attributeType="Boolean" defaultValueString="NO" usesScalarValueType="YES"/>
        <attribute name="tags" optional="YES" attributeType="String"/>
        
        <!-- Source Information -->
        <attribute name="sourceType" attributeType="String" defaultValueString="text"/>
        <attribute name="sourceURL" optional="YES" attributeType="URI"/>
        <attribute name="duration" optional="YES" attributeType="Double" defaultValueString="0.0" usesScalarValueType="YES"/>
        
        <!-- Processing Status -->
        <attribute name="processingStatus" attributeType="String" defaultValueString="pending"/>
        <attribute name="processingError" optional="YES" attributeType="String"/>
        <attribute name="lastProcessingAttempt" optional="YES" attributeType="Date"/>
        
        <!-- Content -->
        <attribute name="originalContent" optional="YES" attributeType="Binary" allowsExternalBinaryDataStorage="YES"/>
        <attribute name="transcript" optional="YES" attributeType="String"/>
        <attribute name="aiGeneratedContent" optional="YES" attributeType="Binary"/>
        <attribute name="supplementaryMaterials" optional="YES" attributeType="Binary"/>
        
        <!-- Study Materials -->
        <attribute name="sections" optional="YES" attributeType="Binary"/>
        <attribute name="mindMap" optional="YES" attributeType="Binary"/>
        <attribute name="keyPoints" optional="YES" attributeType="String"/>
        <attribute name="citations" optional="YES" attributeType="String"/>
        
        <!-- Relationships -->
        <relationship name="folder" optional="YES" maxCount="1" deletionRule="Nullify" destinationEntity="Folder" inverseName="notes" inverseEntity="Folder"/>
        <relationship name="quizProgress" optional="YES" toMany="YES" deletionRule="Cascade" destinationEntity="QuizProgress" inverseName="note" inverseEntity="QuizProgress"/>
        <relationship name="analytics" optional="YES" maxCount="1" deletionRule="Cascade" destinationEntity="QuizAnalytics" inverseName="note" inverseEntity="QuizAnalytics"/>
        
        <!-- Indexes -->
        <fetchIndex name="byIdIndex">
            <fetchIndexElement property="id" type="Binary"/>
        </fetchIndex>
        <fetchIndex name="byTitleIndex">
            <fetchIndexElement property="title" type="Binary"/>
        </fetchIndex>
        <fetchIndex name="byTimestampIndex">
            <fetchIndexElement property="timestamp" type="Binary"/>
        </fetchIndex>
        <fetchIndex name="bySourceTypeIndex">
            <fetchIndexElement property="sourceType" type="Binary"/>
        </fetchIndex>
        <fetchIndex name="byProcessingStatusIndex">
            <fetchIndexElement property="processingStatus" type="Binary"/>
        </fetchIndex>
    </entity>

    <!-- QuizAnalytics Entity - Unchanged -->
    <entity name="QuizAnalytics" representedClassName="QuizAnalytics" syncable="YES" codeGenerationType="class">
        <attribute name="averageScore" attributeType="Double" defaultValueString="0.0" usesScalarValueType="YES"/>
        <attribute name="completedQuizzes" attributeType="Integer 32" defaultValueString="0" usesScalarValueType="YES"/>
        <attribute name="correctAnswers" attributeType="Integer 32" defaultValueString="0" usesScalarValueType="YES"/>
        <attribute name="id" attributeType="UUID" defaultValueString="00000000-0000-0000-0000-000000000000"/>
        <attribute name="noteId" attributeType="UUID" defaultValueString="00000000-0000-0000-0000-000000000000"/>
        <attribute name="topicPerformance" optional="YES" attributeType="Binary"/>
        <attribute name="totalQuestions" attributeType="Integer 32" defaultValueString="0" usesScalarValueType="YES"/>
        <relationship name="note" optional="YES" maxCount="1" deletionRule="Nullify" destinationEntity="Note" inverseName="analytics" inverseEntity="Note"/>
    </entity>

    <!-- QuizProgress Entity - Unchanged -->
    <entity name="QuizProgress" representedClassName="QuizProgress" syncable="YES" codeGenerationType="class">
        <attribute name="answers" optional="YES" attributeType="Binary"/>
        <attribute name="id" attributeType="UUID" defaultValueString="00000000-0000-0000-0000-000000000000"/>
        <attribute name="noteId" attributeType="UUID" defaultValueString="00000000-0000-0000-0000-000000000000"/>
        <attribute name="score" attributeType="Double" defaultValueString="0.0" usesScalarValueType="YES"/>
        <attribute name="timestamp" attributeType="Date" defaultDateTimeInterval="0"/>
        <relationship name="note" optional="YES" maxCount="1" deletionRule="Nullify" destinationEntity="Note" inverseName="quizProgress" inverseEntity="Note"/>
    </entity>

    <!-- Folder Entity - Unchanged -->
    <entity name="Folder" representedClassName="Folder" syncable="YES" codeGenerationType="class">
        <attribute name="id" attributeType="UUID" defaultValueString="00000000-0000-0000-0000-000000000000"/>
        <attribute name="name" attributeType="String" defaultValueString="Untitled Folder"/>
        <attribute name="color" attributeType="String" defaultValueString="blue"/>
        <attribute name="timestamp" attributeType="Date" defaultDateTimeInterval="0"/>
        <attribute name="sortOrder" attributeType="Integer 32" defaultValueString="0" usesScalarValueType="YES"/>
        <relationship name="notes" optional="YES" toMany="YES" deletionRule="Nullify" destinationEntity="Note" inverseName="folder" inverseEntity="Note"/>
        
        <fetchIndex name="byNameIndex">
            <fetchIndexElement property="name" type="Binary"/>
        </fetchIndex>
    </entity>

    <!-- UserSettings Entity - Unchanged -->
    <entity name="UserSettings" representedClassName="UserSettings" syncable="YES" codeGenerationType="class">
        <attribute name="id" attributeType="UUID" defaultValueString="00000000-0000-0000-0000-000000000000"/>
        <attribute name="lastSync" optional="YES" attributeType="Date"/>
        <attribute name="theme" attributeType="String" defaultValueString="system"/>
        <attribute name="analyticsEnabled" attributeType="Boolean" defaultValueString="YES" usesScalarValueType="YES"/>
        <attribute name="biometricEnabled" attributeType="Boolean" defaultValueString="NO" usesScalarValueType="YES"/>
    </entity>

</model>